# 历史基准建立功能开发TodoList

## 进度汇总表

| 功能项 | 进度 |
|--------|------|
| 1. 数据库表结构创建 | ✅ 已完成 |
| 2. 时间特征提取与日期分类函数 | ✅ 已完成 |
| 3. 基础流量数据聚合处理 | ✅ 已完成 |
| 4. OD数据预处理和聚合 | 🟡 部分实现 |
| 5. 基础流量基准计算核心算法 | 🟡 部分实现 |
| 6. OD基准流量分层计算算法 | ⬜ 未见实现 |
| 7. 异常值检测和数据质量控制 | 🟡 仅表结构 |
| 8. 主流程调度与执行脚本 | 🟡 仅表结构 |
| 9. 参数配置和管理模块 | 🟡 仅表结构 |
| 10. 监控告警和日志系统 | 🟡 仅表结构 |

---

## 1. 数据库表结构创建（优先级：高，复杂度：4）
- 说明：设计并创建所有基准计算相关的表结构，包括基准表、参数表、日志表、批次统计表等。
- 关键点：字段类型、主键、唯一约束、索引、注释。
- 建议实现：SQL DDL脚本
- **进度：已完成，所有核心表结构已实现，支持批次统计和自动维护最新批次。**

## 2. 时间特征提取与日期分类函数（优先级：高，复杂度：5）
- 说明：实现时间特征提取和pattern_type分类，支持调休、节假日、免费/收费等。
- 关键点：与dim.dim_holidays表关联，调休识别，pattern_type生成。
- 建议实现：PLPGSQL函数
- **进度：已完成，时间特征提取函数已实现，逻辑完整。**

## 3. 基础流量数据聚合处理（优先级：高，复杂度：6）
- 说明：将5分钟流量数据聚合为小时流量，按pattern_type分组，支持门架、入口、出口、OD等多类型基础流量的小时级聚合与基准生成。
- 关键点：数据窗口、异常值过滤、时间权重、车型细分统计、批次号灵活生成。
- 建议实现：SQL/PLPGSQL
- **进度：已完成，门架/广场/OD等聚合函数已实现，支持新旧数据结构，聚合逻辑参数化，车型细分统计准确。批次统计表自动维护，动态函数支持自动滚动生成最新4周基准数据，避免重复生成。**

## 4. OD数据预处理和聚合（优先级：高，复杂度：7）
- 说明：OD数据清洗、聚合、分级，生成OD对标识和分层。
- 关键点：行程时间合理性、重复记录过滤、OD重要性分级。
- 建议实现：SQL/PLPGSQL
- **进度：部分实现，OD聚合函数已实现，分级等细节待补充。**

## 5. 基础流量基准计算核心算法（优先级：高，复杂度：8）
- 说明：按pattern_type、小时、站点分组加权平均，平滑处理。
- 关键点：时间衰减权重、数据充足性、降级策略。
- 建议实现：PLPGSQL函数/存储过程
- **进度：部分实现，基础聚合已实现，高级特性待补充。**

## 6. OD基准流量分层计算算法（优先级：高，复杂度：9）
- 说明：OD对分层、权重、相似性辅助、区域平均等多策略基准计算。
- 关键点：分层阈值、类型权重、相似OD辅助、区域平均。
- 建议实现：PLPGSQL函数/存储过程
- **进度：未见实现，需新开发。**

## 7. 异常值检测和数据质量控制（优先级：中，复杂度：6）
- 说明：实现3σ异常检测、插值、完整性检查、质量评分。
- 关键点：动态边界、插值策略、日志记录。
- 建议实现：PLPGSQL函数/SQL
- **进度：仅表结构，算法实现待补充。**

## 8. 主流程调度与执行脚本（优先级：中，复杂度：7）
- 说明：实现每日定时调度、增量/全量切换、异常恢复、报告生成。
- 关键点：调度依赖、执行监控、参数化。
- 建议实现：PLPGSQL存储过程+Python调度脚本
- **进度：仅表结构，调度脚本待开发。**

## 9. 参数配置和管理模块（优先级：中，复杂度：5）
- 说明：参数表设计、动态加载、历史记录、场景预设。
- 关键点：参数有效性、变更追踪、回滚机制。
- 建议实现：SQL/PLPGSQL
- **进度：仅表结构，动态加载等功能待开发。**

## 10. 监控告警和日志系统（优先级：中，复杂度：6）
- 说明：执行状态、性能、业务质量、异常告警、日志记录。
- 关键点：日志表、告警触发、可视化。
- 建议实现：SQL/PLPGSQL/Python 
- **进度：仅表结构，告警与可视化功能待开发。** 